ext {
  major = project.property('artifactMajorVersion')
  minor = project.property('artifactMinorVersion')
  patch = project.property('artifactPatchVersion')
  buildNum = 'LOCAL'

  getMasterVersion = {
    if (rootProject.hasProperty('teamcity')) {
      teamcity['build.major'] = major
      teamcity['build.minor'] = minor
      teamcity['build.patch'] = patch

      if (teamcity['build.number'].contains('.')) {
        buildNum = teamcity['build.number'].split('\\.')[2]
      } else {
        buildNum = teamcity['build.number']
      }

      print '##teamcity[buildNumber \'' + major + '.' + minor + '.' + buildNum + '\']'
    } else {
      ext.env = System.getenv()
      def buildNumber = env.BUILD_NUMBER?.toInteger()
      if (buildNumber) {
        buildNum = buildNumber
        println '##jenkins[buildNumber \'' + major + '.' + minor + '.' + buildNum + '\']'
      }
    }

    return major + '.' + minor + '.' + buildNum
  }

  getBranchVersion = { branchName ->
    return major + '.' + minor + '.' + patch + '-' + branchName + '-SNAPSHOT'
  }
}
